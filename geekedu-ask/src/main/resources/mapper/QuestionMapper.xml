<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zch.ask.mapper.QuestionMapper">

	<resultMap id="questionResultMap" type="com.zch.ask.domain.po.Question">
		<id column="id" property="id" />
		<result column="title" property="title" />
		<result column="content" property="content" />
		<result column="category_id" property="categoryId" />
		<result column="view_count" property="viewCount" />
		<result column="comment_count" property="commentCount" />
		<result column="user_id" property="userId" />
		<result column="reward_score" property="rewardScore" />
		<result column="question_status" property="questionStatus" />
		<result column="images" property="images" />
		<result column="created_by" property="createdBy" />
		<result column="updated_by" property="updatedBy" />
		<result column="is_delete" property="isDelete" />
	</resultMap>

	<!-- 定义可复用的SQL片段 -->
	<sql id="questionColumns">
		id, title, content, category_id, view_count, comment_count, user_id, reward_score, question_status, images, created_by, created_time, updated_by, updated_time, is_delete
	</sql>

	<select id="getQuestionPageByCondition" resultMap="questionResultMap">
		select
		<include refid="questionColumns" />
		from question
		where 1=1
		<if test="keywords != '' and keywords != null">
			and title like concat('%', #{keywords}, '%')
		</if>
		<if test="categoryId != null">
			and category_id = #{categoryId}
		</if>
		<if test="userId != null">
			and user_id = #{userId}
		</if>
		<if test="status != -1">
			and question_status = #{status}
		</if>
		<if test="(sort == '' and sort == null) or (order == '' and order == null)">
			order by id desc
		</if>
		<if test="(sort != '' and sort != null) and (order != '' and order != null)">
			order by ${sort} ${order}
		</if>
		<if test="pageNum == null or pageSize == null">
			limit 0, 10
		</if>
		<if test="pageNum != null and pageSize != null">
			limit #{pageNum}, #{pageSize}
		</if>
	</select>

</mapper>
